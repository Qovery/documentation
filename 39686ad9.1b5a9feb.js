/*! For license information please see 39686ad9.1b5a9feb.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{222:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return r})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return l})),n.d(t,"default",(function(){return u}));var o=n(1),a=n(9),i=(n(0),n(467)),r=(n(475),n(466),n(471),{last_modified_on:"2024-01-22",title:"Deploying with the auto-deploy feature",description:"Learn how to deploy with the auto-deploy feature"}),c={id:"using-qovery/deployment/deploying-with-auto-deploy",title:"Deploying with the auto-deploy feature",description:"Learn how to deploy with the auto-deploy feature",source:"@site/docs/using-qovery/deployment/deploying-with-auto-deploy.md",permalink:"/docs/using-qovery/deployment/deploying-with-auto-deploy",sidebar:"docs",previous:{title:"Deployment",permalink:"/docs/using-qovery/deployment"},next:{title:"Deploying with your CI/CD",permalink:"/docs/using-qovery/deployment/deploying-with-ci-cd"}},l=[{value:"How to activate it",id:"how-to-activate-it",children:[{value:"Filtering commits triggering the auto-deploy",id:"filtering-commits-triggering-the-auto-deploy",children:[]}]},{value:"Auto-deploy and container images",id:"auto-deploy-and-container-images",children:[]},{value:"FAQ",id:"faq",children:[{value:"Can I exclude some commits from the auto-deploy feature",id:"can-i-exclude-some-commits-from-the-auto-deploy-feature",children:[]},{value:"Are my stopped services restarted",id:"are-my-stopped-services-restarted",children:[]},{value:"How does it work with mono-repositories",id:"how-does-it-work-with-mono-repositories",children:[]},{value:"Does Qovery check if a new image is available for my service",id:"does-qovery-check-if-a-new-image-is-available-for-my-service",children:[]}]}],s={rightToc:l};function u(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(o.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Once you have configured your services and deployed them for the first time, you can decide to automatically update the applications to the latest version of your git branch thanks to the auto-deploy feauture."),Object(i.b)("p",null,"Each time a commit is pushed on your git repository, Qovery receives a webhook call containing the commit information (who did it, what changed, which branch etc..). Thanks to this information, Qovery is able to determine which application should be automatically re-deployed with the new version."),Object(i.b)("h2",{id:"how-to-activate-it"},"How to activate it"),Object(i.b)("p",null,"The auto-deploy feature can be activated from the application settings, by switching on the auto-deploy flag."),Object(i.b)("p",{align:"center"},Object(i.b)("img",{src:"/img/deployment/auto-deploy-settings.png",alt:"Auto-deploy settings"})),Object(i.b)("p",null,"It can also be activated on the first step of the service creation flow"),Object(i.b)("p",{align:"center"},Object(i.b)("img",{src:"/img/deployment/auto-deploy-creation-flow.png",alt:"Auto-deploy creation flow"})),Object(i.b)("p",null,"Once this flag is activated, every new commit pushed on the branch of the application will trigger an automatic deployment of the new version."),Object(i.b)("h3",{id:"filtering-commits-triggering-the-auto-deploy"},"Filtering commits triggering the auto-deploy"),Object(i.b)("p",null,"By default every new commit pushed on the branch will trigger a deployment of the application. You can use the ",Object(i.b)("inlineCode",{parentName:"p"},"Deployment restrictions")," feature to include or exclude certain files or folders from the feature and avoid un-necessary deployments (like a change on the README file)."),Object(i.b)("p",null,"To add a new restriction, go into the ",Object(i.b)("inlineCode",{parentName:"p"},"Deployment restrictions")," section of your application settings."),Object(i.b)("p",{align:"center"},Object(i.b)("img",{src:"/img/deployment/deployment_restrictions.png",alt:"Deployment restrictions"})),Object(i.b)("p",null,"When adding a new restriction, two modes can be selected:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},'EXCLUDE: commits on the file or folder defined in the "Value" field will be ignored'),Object(i.b)("li",{parentName:"ul"},'MATCH: only commits on the file or folder defined in the "Value" field will trigger a deployment')),Object(i.b)("p",null,"Note: "),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},'"Value" should contain the full file path and can\'t start with ',Object(i.b)("inlineCode",{parentName:"li"},"/")),Object(i.b)("li",{parentName:"ul"},'Wildcards are not supported in the "Value" field (you can specify "my-prefix*" to exclude commits on files starting with "my-prefix")')),Object(i.b)("h2",{id:"auto-deploy-and-container-images"},"Auto-deploy and container images"),Object(i.b)("p",null,"The auto-deploy feature can be activated as well if you directly deploy your container images but it requires some additional integration via your CI/CD. Your CI/CD has to inform Qovery that a new version of the image (a new tag) is available for a specific container image. Thanks to this information, Qovery can find any application that uses this container image and automatically trigger a deployment of the new image tag."),Object(i.b)("p",null,"To inform Qovery of the new version, your CI/CD needs to call the following endpoints, depending on the service type:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Container: ",Object(i.b)("a",Object(o.a)({parentName:"li"},{href:"https://api-doc.qovery.com/#tag/Containers/operation/autoDeployContainerEnvironments"}),"https://api-doc.qovery.com/#tag/Containers/operation/autoDeployContainerEnvironments")),Object(i.b)("li",{parentName:"ul"},"Lifecycle job / cronjob: ",Object(i.b)("a",Object(o.a)({parentName:"li"},{href:"https://api-doc.qovery.com/#tag/Jobs/operation/autoDeployJobEnvironments"}),"https://api-doc.qovery.com/#tag/Jobs/operation/autoDeployJobEnvironments"))),Object(i.b)("h2",{id:"faq"},"FAQ"),Object(i.b)("h3",{id:"can-i-exclude-some-commits-from-the-auto-deploy-feature"},"Can I exclude some commits from the auto-deploy feature"),Object(i.b)("p",null,"Yes, take a look at ",Object(i.b)("a",Object(o.a)({parentName:"p"},{href:"#filtering-commits-triggering-the-auto-deploy"}),"this section"),"."),Object(i.b)("h3",{id:"are-my-stopped-services-restarted"},"Are my stopped services restarted"),Object(i.b)("p",null,"If you have the auto-deploy feature activated on your service and you stop it, the next commit on the service's branch won't start the service. You have to manually start it."),Object(i.b)("h3",{id:"how-does-it-work-with-mono-repositories"},"How does it work with mono-repositories"),Object(i.b)("p",null,"The auto-deploy feature works on mono-repositories as well, triggering a deployment of any service linked to the mono-repository. If you want to trigger a deployment only if a commit is done on the sub-folder of the app, add a ",Object(i.b)("inlineCode",{parentName:"p"},"Deployment Restriction")," to include only that repository. (Have a look at ",Object(i.b)("a",Object(o.a)({parentName:"p"},{href:"#filtering-commits-triggering-the-auto-deploy"}),"this section"),")"),Object(i.b)("h3",{id:"does-qovery-check-if-a-new-image-is-available-for-my-service"},"Does Qovery check if a new image is available for my service"),Object(i.b)("p",null,"No, there's no automatic hook on your container registry verifying that a new image is available to trigger a deployment. You have to inform Qovery about the new version and trigger a deployment:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"manually: updating the version on the console and triggering a deployment"),Object(i.b)("li",{parentName:"ul"},"CLI: deploying the new version with the ",Object(i.b)("inlineCode",{parentName:"li"},"qovery <service> deploy --tag"),"  command. See ",Object(i.b)("a",Object(o.a)({parentName:"li"},{href:"/docs/using-qovery/integration/continuous-integration/github-actions/#deploy-a-container-application"}),"this section")),Object(i.b)("li",{parentName:"ul"},"via the API: you have two options\n-- call the ",Object(i.b)("a",Object(o.a)({parentName:"li"},{href:"https://api-doc.qovery.com/#tag/Environment-Actions/operation/deployAllServices"}),"deployment endpoint")," with the new tag for that service\n-- use a ",Object(i.b)("a",Object(o.a)({parentName:"li"},{href:"https://api-doc.qovery.com/#tag/Containers/operation/autoDeployContainerEnvironments"}),"auto-deploy containers endpoint")," that will trigger the deployment of any service using the same image within the organization and having the auto-deploy feature activated")))}u.isMDXComponent=!0},465:function(e,t,n){var o;!function(){"use strict";var n={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var o=arguments[t];if(o){var i=typeof o;if("string"===i||"number"===i)e.push(o);else if(Array.isArray(o)&&o.length){var r=a.apply(null,o);r&&e.push(r)}else if("object"===i)for(var c in o)n.call(o,c)&&o[c]&&e.push(c)}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(o=function(){return a}.apply(t,[]))||(e.exports=o)}()},466:function(e,t,n){"use strict";n(468);var o=n(0),a=n.n(o),i=n(465),r=n.n(i);n(132);t.a=function(e){var t=e.children,n=e.classNames,o=e.fill,i=e.icon,c=e.type,l=null;switch(c){case"danger":l="alert-triangle";break;case"success":l="check-circle";break;case"warning":l="alert-triangle";break;default:l="info"}return a.a.createElement("div",{className:r()(n,"alert","alert--"+c,{"alert--fill":o,"alert--icon":!1!==i}),role:"alert"},!1!==i&&a.a.createElement("i",{className:r()("feather","icon-"+(i||l))}),t)}},467:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h}));var o=n(0),a=n.n(o);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=a.a.createContext({}),u=function(e){var t=a.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):c({},t,{},e)),n},p=function(e){var t=u(e.components);return a.a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},m=Object(o.forwardRef)((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,r=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),p=u(n),m=o,h=p["".concat(r,".").concat(m)]||p[m]||d[m]||i;return n?a.a.createElement(h,c({ref:t},s,{components:n})):a.a.createElement(h,c({ref:t},s))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=m;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:o,r[1]=c;for(var s=2;s<i;s++)r[s]=n[s];return a.a.createElement.apply(null,r)}return a.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},468:function(e,t,n){var o=n(12);o(o.P,"Array",{fill:n(469)}),n(74)("fill")},469:function(e,t,n){"use strict";var o=n(27),a=n(75),i=n(26);e.exports=function(e){for(var t=o(this),n=i(t.length),r=arguments.length,c=a(r>1?arguments[1]:void 0,n),l=r>2?arguments[2]:void 0,s=void 0===l?n:a(l,n);s>c;)t[c++]=e;return t}},470:function(e,t,n){var o=n(28).f,a=Function.prototype,i=/^\s*function ([^ (]*)/;"name"in a||n(10)&&o(a,"name",{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(e){return""}}})},471:function(e,t,n){"use strict";n(470);var o=n(0),a=n.n(o),i=n(466);t.a=function(e){var t=e.children,n=e.name;return a.a.createElement(i.a,{type:"info",fill:!0,icon:!1,rounded:!0,className:"list--icons list--icons--arrow list--tight list--indent margin-bottom--lg"},a.a.createElement("p",{class:"text--lg margin-bottom--sm",style:{marginTop:"-0.25em"}},"Before you begin, this ",n||"page"," assumes the following:"),t)}},472:function(e,t,n){"use strict";var o=n(1),a=n(0),i=n.n(a),r=n(39),c=n(476),l=n(20),s=n.n(l);t.a=function(e){var t,n=e.to,l=e.href,u=n||l,p=Object(c.a)(u),d=Object(a.useRef)(!1),m=s.a.canUseIntersectionObserver;return Object(a.useEffect)((function(){return!m&&p&&window.docusaurus.prefetch(u),function(){m&&t&&t.disconnect()}}),[u,m,p]),u&&p?i.a.createElement(r.b,Object(o.a)({},e,{onMouseEnter:function(){d.current||(window.docusaurus.preload(u),d.current=!0)},innerRef:function(e){var n,o;m&&e&&p&&(n=e,o=function(){window.docusaurus.prefetch(u)},(t=new window.IntersectionObserver((function(e){e.forEach((function(e){n===e.target&&(e.isIntersecting||e.intersectionRatio>0)&&(t.unobserve(n),t.disconnect(),o())}))}))).observe(n))},to:u})):i.a.createElement("a",Object(o.a)({},e,{href:u}))}},475:function(e,t,n){"use strict";var o=n(0),a=n.n(o),i=n(472),r=n(465),c=n.n(r);n(134);t.a=function(e){var t=e.children,n=e.className,o=e.badge,r=e.leftIcon,l=e.rightIcon,s=e.size,u=e.target,p=e.to,d=c()("jump-to","jump-to--"+s,n),m=a.a.createElement("div",{className:"jump-to--inner"},a.a.createElement("div",{className:"jump-to--inner-2"},r&&a.a.createElement("div",{className:"jump-to--left"},a.a.createElement("i",{className:"feather icon-"+r})),a.a.createElement("div",{className:"jump-to--main"},o?a.a.createElement("span",{className:"badge badge--primary badge--right"},o):"",t),a.a.createElement("div",{className:"jump-to--right"},a.a.createElement("i",{className:"feather icon-"+(l||"chevron-right")+" arrow"}))));return u?a.a.createElement("a",{href:p,target:u,className:d},m):a.a.createElement(i.a,{to:p,className:d},m)}},476:function(e,t,n){"use strict";function o(e){return!1===/^(https?:|\/\/)/.test(e)}n.d(t,"a",(function(){return o}))}}]);
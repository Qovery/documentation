---
last_modified_on: "2024-01-11"
title: "Create Demo Cluster"
description: "Learn how to create a Kubernetes cluster with k3d for demo purposes"
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

import Steps from '@site/src/components/Steps';
import Alert from '@site/src/components/Alert';
import Assumptions from '@site/src/components/Assumptions';

<Alert type="warning">

This setup is just for demo purposes. If you want to use Qovery in production, you should use a managed Kubernetes cluster or even k3d but with a better setup. Feel free to contact us on our [Community forum][urls.qovery_forum] if you need help.

</Alert>

This page explains how to set up a local Kubernetes cluster with [k3d](https://k3d.io).

<Assumptions>

* You have [helm][urls.helm] installed on your machine

</Assumptions>

<!--
     THIS FILE IS AUTOGENERATED!

     To make changes please edit the template located at:

     website/docs/getting-started/install-qovery/kubernetes/create-k8s-cluster.md.erb
-->

## Install and Run k3d

<Steps headingDepth={3}>

<ol>

<li>

### Configure the container registry

Configure the container registry access as explained in [this section][docs.getting-started.install-qovery.kubernetes.requirements#container-registry].

</li>

<li>

### Install k3d

<Tabs
centered={true}
className={"rounded"}
defaultValue={"ecr"}
placeholder="Select a Container Registry"
select={false}
size={null}
values={[
{"group":"Registry","label":"ECR","value":"ecr"},
{"group":"Registry","label":"GCR","value":"gcr"},
]}>

<TabItem value="ecr">

Create the `registry_bin` folder and `ecr-credential-provider` file for the ECR Credential Provider service:

```bash
mkdir -p registry_bin
touch registry_bin/ecr-credential-provider
chmod 755 registry_bin/ecr-credential-provider
```

Now we can run a local Kubernetes cluster (update the path to `config.yaml` file, and the Kubernetes [image tag version](https://hub.docker.com/r/rancher/k3s/tags)):

```bash
k3d cluster create --image rancher/k3s:v1.26.11-k3s2 --k3s-arg "--disable=traefik,metrics-server@server:0" \
-v $(pwd)/registry_bin:/var/lib/rancher/credentialprovider/bin@server:0  \
-v $(pwd)/config.yaml:/var/lib/rancher/credentialprovider/config.yaml@server:0
```

Now we need to install the ECR Credential Provider binary into the Kubernetes nodes. We will use a Kubernetes Job to do that:

```yaml
apiVersion: batch/v1
kind: Job
metadata:
  name: cloud-provider-repository-binary-builder
spec:
  backoffLimit: 0
  template:
    spec:
      restartPolicy: Never
      containers:
      - name: ecr-credential-builder
        image: alpine:3.18
        command:
          - /bin/sh
          - -c
          - |
            apk add -U ca-certificates tar zstd tzdata go git
            git clone https://github.com/kubernetes/cloud-provider-aws.git
            cd cloud-provider-aws/cmd/ecr-credential-provider
            CGO_ENABLED=0 go build -mod=readonly .
            chmod 755 ecr-credential-provider
            mkdir -p /mnt/host/var/lib/rancher/credentialprovider/bin/
            cp ecr-credential-provider /mnt/host/var/lib/rancher/credentialprovider/bin/
        volumeMounts:
        - mountPath: /mnt/host
          name: host
      volumes:
      - hostPath:
          path: /
          type: ""
        name: host
```

You can now move on the Qovery Helm deployment.

</TabItem>

<TabItem value="gcr">

Work in progress

</TabItem>

</Tabs>

</li>

<li>

### Check your cluster

<Tabs
centered={true}
className={"rounded"}
defaultValue={"ecr"}
placeholder="Select a Container Registry"
select={false}
size={null}
values={[
{"group":"Registry","label":"ECR","value":"ecr"},
{"group":"Registry","label":"GCR","value":"gcr"},
]}>

<TabItem value="ecr">

Run the following command to check that your cluster is ready with your ECR credentials:

```bash
TODO
```

</TabItem>

<TabItem value="gcr">

Work in progress

</TabItem>

</Tabs>

</li>

</ol>

</Steps>

## Next Steps

Congratulations! You have successfully created a Kubernetes cluster with k3d. You are now ready to install Qovery BYOK on your cluster. Next step: [Install Qovery BYOK][docs.getting-started.install-qovery.kubernetes.quickstart#install-qovery]


[docs.getting-started.install-qovery.kubernetes.quickstart#install-qovery]: /docs/getting-started/install-qovery/kubernetes/quickstart/#install-qovery
[docs.getting-started.install-qovery.kubernetes.requirements#container-registry]: /docs/getting-started/install-qovery/kubernetes/requirements/#container-registry
[urls.helm]: https://helm.sh
[urls.qovery_forum]: https://discuss.qovery.com/

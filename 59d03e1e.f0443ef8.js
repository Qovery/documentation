/*! For license information please see 59d03e1e.f0443ef8.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[121],{272:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return u})),n.d(t,"default",(function(){return p}));var o=n(1),r=n(9),a=(n(0),n(475)),i=(n(482),n(479),n(474)),c={last_modified_on:"2024-12-18",$schema:"/.meta/.schemas/guides.json",title:"Configure Single Sign-On (SSO) for an AWS sub-account",description:"Learn how to configure Single Sign-On (SSO) on AWS for a sub-account in Qovery.",author_github:"https://github.com/deimosfr",tags:["type: guide","technology: qovery"]},s={categories:[{name:"advanced",title:"Advanced",description:"Go beyond the basics, become a Qovery pro, and extract the full potential of Qovery.",permalink:"/guides/advanced"}],coverLabel:"Configure Single Sign-On (SSO) for an AWS sub-account",description:"Learn how to configure Single Sign-On (SSO) on AWS for a sub-account in Qovery.",permalink:"/guides/advanced/sub-account-sso",readingTime:"3 min read",source:"@site/guides/advanced/sub-account-sso.md",tags:[{label:"type: guide",permalink:"/guides/tags/type-guide"},{label:"technology: qovery",permalink:"/guides/tags/technology-qovery"}],title:"Configure Single Sign-On (SSO) for an AWS sub-account",truncated:!1,prevItem:{title:"Build E2E Testing Ephemeral Environments with GitHub Actions and Qovery",permalink:"/guides/tutorial/build-e2e-testing-ephemeral-environments"},nextItem:{title:"Continuous Integration",permalink:"/guides/advanced/continuous-integration"}},u=[],l={rightToc:u};function p(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(a.b)("wrapper",Object(o.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("p",null,"Creating a sub-account on AWS is a great way to manage multiple projects and resources. It allows you to separate resources, billing, and access control.\nHowever, managing multiple accounts can be cumbersome. Single Sign-On (SSO) is a great way to manage multiple accounts and resources."),Object(a.b)("p",null,"In this guide, you will learn how to configure Single Sign-On (SSO) for a sub-account in AWS with Qovery. Then it's convenient to switch between accounts. Here is an example of what it looks like with 5 different accounts:"),Object(a.b)("p",{align:"center"},Object(a.b)("img",{src:"/img/aws-subaccount-sso/sso-login-subaccount.png",alt:"sso login"})),Object(a.b)("h1",{id:"create-a-subaccount-in-aws"},"Create a subaccount in AWS"),Object(a.b)("p",null,"On your AWS master account, go to the ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://aws.amazon.com/console/"}),"AWS Management Console"),", and click on the ",Object(a.b)("inlineCode",{parentName:"p"},"My Account")," top right dropdown menu.\nThen, click on ",Object(a.b)("inlineCode",{parentName:"p"},"AWS Organizations"),", and click on ",Object(a.b)("inlineCode",{parentName:"p"},"Add an AWS account"),":"),Object(a.b)("p",{align:"center"},Object(a.b)("img",{src:"/img/aws-subaccount-sso/add-subaccount.png",alt:"sub account creation"})),Object(a.b)(i.a,{type:"info",mdxType:"Alert"},Object(a.b)("p",null,'Fill in the "IAM Role Name" with a meaningful name. This will typically be displayed when users are switching to this account, so it should clearly identify this sub-account.')),Object(a.b)("p",null,"If all goes well, this takes us back to the list of accounts. If the new one looks grayed out, it\u2019s not quite done being created; wait a little and refresh the list until it looks normal.\nLog out of the master account, and connect to this account."),Object(a.b)("h1",{id:"configure-sso-on-aws-for-the-sub-account"},"Configure SSO on AWS for the sub-account"),Object(a.b)("p",null,"You will find ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://docs.aws.amazon.com/singlesignon/latest/userguide/tutorials.html"}),"in this guide"),", how to configure SSO on your subaccount with your identity provider (Google Workspace, Okta, Microsoft Active Directory etc.)."),Object(a.b)("p",null,"In the ends, you should see your users in the AWS IAM Identity Center console:"),Object(a.b)("p",{align:"center"},Object(a.b)("img",{src:"/img/aws-subaccount-sso/iic-users-list.png",alt:"iic user list"})),Object(a.b)("h1",{id:"ass-sso-with-qovery-on-your-eks-cluster-to-support-sso-optional"},"Ass SSO (with Qovery) on your EKS cluster to support SSO (optional)"),Object(a.b)("p",null,"Qovery allows you to connect to your EKS cluster using SSO. It's optional, but if you want to do this anyway, please ",Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"/guides/tutorial/how-to-activate-sso-to-connect-to-your-eks-cluster"}),"refer to this guide"),"."),Object(a.b)("h1",{id:"sso-sync-for-google-workspace-optional"},"SSO sync for Google workspace (optional)"),Object(a.b)("p",null,Object(a.b)("a",Object(o.a)({parentName:"p"},{href:"https://github.com/awslabs/ssosync"}),"SSO Sync")," is helping you populate AWS SSO directly from your Google Workspace users. It's optional, you can use it inside Qovery with a Dockerfile (clone the repo and add this Dockerfile, feel free to update to your needs):"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{}),'FROM debian:stable-slim\n\nRUN apt-get update && apt-get -y install curl && apt-get clean &&\\\n    curl -Lo ssosync.tgz https://github.com/awslabs/ssosync/releases/download/v2.0.2/ssosync_Linux_x86_64.tar.gz &&\\\n    tar -xzf ssosync.tgz -C /tmp &&\\\n    cp /tmp/ssosync /usr/bin/ &&\\\n    chmod 755 /usr/bin/ssosync &&\\\n    rm -Rf ssosync.tgz /tmp/*\n\nENTRYPOINT ["/usr/bin/ssosync"]\n')),Object(a.b)("p",null,"Then you can try to run it. For example, to sync users from Google Workspace to AWS SSO:"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{}),"docker run -t $(AWS_SSO_SCIM_API_ACCESS_TOKEN) -e $(AWS_SSO_SCIM_API_ENDPOINT) -u $(GOOGLE_WORKSPACE_ADMIN_USER_EMAIL) -c $(GOOGLE_WORKSPACE_CREDENTIALS_FILE) -g $(GOOGLE_WORKSPACE_GROUPS) --log-level debug -r $(AWS_REGION) -i $(AWS_SSO_SCIM_IDENTITY_STORE_ID)\n")),Object(a.b)("p",null,"You should see something like:"),Object(a.b)("pre",null,Object(a.b)("code",Object(o.a)({parentName:"pre"},{}),'time="2024-12-18T14:30:00Z" level=info msg="Syncing AWS users and groups from Google Workspace SAML Application"\ntime="2024-12-18T14:30:00Z" level=info msg=syncing sync_method=groups\ntime="2024-12-18T14:30:00Z" level=info msg="get google groups" query="name:sso* email:sso*"\ntime="2024-12-18T14:30:01Z" level=debug msg="preparing list of google users and then google groups and their members"\n...\ntime="2024-12-18T14:30:26Z" level=info msg="sync completed"\n')))}p.isMDXComponent=!0},473:function(e,t,n){var o;!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var o=arguments[t];if(o){var a=typeof o;if("string"===a||"number"===a)e.push(o);else if(Array.isArray(o)&&o.length){var i=r.apply(null,o);i&&e.push(i)}else if("object"===a)for(var c in o)n.call(o,c)&&o[c]&&e.push(c)}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(o=function(){return r}.apply(t,[]))||(e.exports=o)}()},474:function(e,t,n){"use strict";n(476);var o=n(0),r=n.n(o),a=n(473),i=n.n(a);n(132);t.a=function(e){var t=e.children,n=e.classNames,o=e.fill,a=e.icon,c=e.type,s=null;switch(c){case"danger":s="alert-triangle";break;case"success":s="check-circle";break;case"warning":s="alert-triangle";break;default:s="info"}return r.a.createElement("div",{className:i()(n,"alert","alert--"+c,{"alert--fill":o,"alert--icon":!1!==a}),role:"alert"},!1!==a&&r.a.createElement("i",{className:i()("feather","icon-"+(a||s))}),t)}},475:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return d}));var o=n(0),r=n.n(o);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var u=r.a.createContext({}),l=function(e){var t=r.a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):c({},t,{},e)),n},p=function(e){var t=l(e.components);return r.a.createElement(u.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},f=Object(o.forwardRef)((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,i=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=l(n),f=o,d=p["".concat(i,".").concat(f)]||p[f]||b[f]||a;return n?r.a.createElement(d,c({ref:t},u,{components:n})):r.a.createElement(d,c({ref:t},u))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=f;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:o,i[1]=c;for(var u=2;u<a;u++)i[u]=n[u];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,n)}f.displayName="MDXCreateElement"},476:function(e,t,n){var o=n(12);o(o.P,"Array",{fill:n(477)}),n(74)("fill")},477:function(e,t,n){"use strict";var o=n(27),r=n(75),a=n(26);e.exports=function(e){for(var t=o(this),n=a(t.length),i=arguments.length,c=r(i>1?arguments[1]:void 0,n),s=i>2?arguments[2]:void 0,u=void 0===s?n:r(s,n);u>c;)t[c++]=e;return t}},478:function(e,t,n){var o=n(28).f,r=Function.prototype,a=/^\s*function ([^ (]*)/;"name"in r||n(10)&&o(r,"name",{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(e){return""}}})},479:function(e,t,n){"use strict";n(478);var o=n(0),r=n.n(o),a=n(474);t.a=function(e){var t=e.children,n=e.name;return r.a.createElement(a.a,{type:"info",fill:!0,icon:!1,rounded:!0,className:"list--icons list--icons--arrow list--tight list--indent margin-bottom--lg"},r.a.createElement("p",{class:"text--lg margin-bottom--sm",style:{marginTop:"-0.25em"}},"Before you begin, this ",n||"page"," assumes the following:"),t)}},481:function(e,t,n){"use strict";var o=n(485),r=n(51);function a(e,t){return t.encode?t.strict?o(e):encodeURIComponent(e):e}t.extract=function(e){return e.split("?")[1]||""},t.parse=function(e,t){var n=function(e){var t;switch(e.arrayFormat){case"index":return function(e,n,o){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===o[e]&&(o[e]={}),o[e][t[1]]=n):o[e]=n};case"bracket":return function(e,n,o){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==o[e]?o[e]=[].concat(o[e],n):o[e]=[n]:o[e]=n};default:return function(e,t,n){void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t=r({arrayFormat:"none"},t)),o=Object.create(null);return"string"!=typeof e?o:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),r=t.shift(),a=t.length>0?t.join("="):void 0;a=void 0===a?null:decodeURIComponent(a),n(decodeURIComponent(r),a,o)})),Object.keys(o).sort().reduce((function(e,t){var n=o[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return t[e]})):t}(n):e[t]=n,e}),Object.create(null))):o},t.stringify=function(e,t){var n=function(e){switch(e.arrayFormat){case"index":return function(t,n,o){return null===n?[a(t,e),"[",o,"]"].join(""):[a(t,e),"[",a(o,e),"]=",a(n,e)].join("")};case"bracket":return function(t,n){return null===n?a(t,e):[a(t,e),"[]=",a(n,e)].join("")};default:return function(t,n){return null===n?a(t,e):[a(t,e),"=",a(n,e)].join("")}}}(t=r({encode:!0,strict:!0,arrayFormat:"none"},t));return e?Object.keys(e).sort().map((function(o){var r=e[o];if(void 0===r)return"";if(null===r)return a(o,t);if(Array.isArray(r)){var i=[];return r.slice().forEach((function(e){void 0!==e&&i.push(n(o,e,i.length))})),i.join("&")}return a(o,t)+"="+a(r,t)})).filter((function(e){return e.length>0})).join("&"):""}},482:function(e,t,n){"use strict";var o=n(0),r=n.n(o),a=(n(473),n(481)),i=n.n(a);n(133);t.a=function(e){var t=e.children,n=e.headingDepth,a=e.hideFeedbackQuestion,c="undefined"!=typeof window?window.location:null,s={title:"Tutorial on "+c+" failed",body:"The tutorial on:\n\n"+c+"\n\nHere's what went wrong:\n\n\x3c!-- Insert command output and details. Thank you for reporting! :) --\x3e"},u="https://github.com/qovery/documentation/issues/new?"+i.a.stringify(s),l=Object(o.useState)(null),p=l[0],b=l[1];return r.a.createElement("div",{className:"steps steps--h"+n},t,!a&&!p&&r.a.createElement("div",{className:"steps--feedback"},"How was it? Did this tutorial work?\xa0\xa0",r.a.createElement("span",{className:"button button--sm button--primary",onClick:function(){return b("yes")}},"Yes"),"\xa0\xa0",r.a.createElement("a",{href:u,target:"_blank",className:"button button--sm button--primary"},"No")),"yes"==p&&r.a.createElement("div",{className:"steps--feedback steps--feedback--success"},"Thanks! If you're enjoying Qovery please consider ",r.a.createElement("a",{href:"https://github.com/qovery/documentation/",target:"_blank"},"starring our Github repo"),"."))}},485:function(e,t,n){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}}}]);
/*! For license information please see d9472068.abc6da1b.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[246],{398:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return s})),n.d(t,"rightToc",(function(){return u})),n.d(t,"default",(function(){return p}));var r=n(1),a=n(9),o=(n(0),n(447)),l=n(454),i=n(446),c={last_modified_on:"2024-02-20",title:"Installing on AWS EKS",description:"Learn how to install and configure Qovery on your own AWS EKS cluster"},s={id:"getting-started/install-qovery/kubernetes/installation-aws",title:"Installing on AWS EKS",description:"Learn how to install and configure Qovery on your own AWS EKS cluster",source:"@site/docs/getting-started/install-qovery/kubernetes/installation-aws.md",permalink:"/docs/getting-started/install-qovery/kubernetes/installation-aws",sidebar:"docs",previous:{title:"Create Demo Cluster",permalink:"/docs/getting-started/install-qovery/kubernetes/create-k8s-cluster"},next:{title:"Validate the installation",permalink:"/docs/getting-started/install-qovery/kubernetes/validate-installation"}},u=[{value:"Requirements",id:"requirements",children:[]},{value:"Install your cluster",id:"install-your-cluster",children:[]},{value:"Get the AWS credentials",id:"get-the-aws-credentials",children:[]},{value:"Install Qovery",id:"install-qovery",children:[]},{value:"Validate the installation",id:"validate-the-installation",children:[]},{value:"Further configuration",id:"further-configuration",children:[]}],b={rightToc:u};function p(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(o.b)("wrapper",Object(r.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)(i.a,{type:"warning",mdxType:"Alert"},Object(o.b)("p",null,"This page is dedicated to AWS EKS users and is temporary until BYOK is GA. Contact us if you have any questions.")),Object(o.b)("p",null,"In this section, we will explain how to install Qovery on an EKS cluster running on your AWS account."),Object(o.b)("h2",{id:"requirements"},"Requirements"),Object(o.b)("p",null,"Have a look at the ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"/docs/getting-started/install-qovery/kubernetes/requirements/"}),"Requirements")," section."),Object(o.b)("h2",{id:"install-your-cluster"},"Install your cluster"),Object(o.b)("p",null,"If you don't have already an EKS cluster, create one on your AWS account and create a set of worker nodes with enough resources to run Qovery and your applications. "),Object(o.b)("p",null,"For the Kubernetes requirements, check the ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"/docs/getting-started/install-qovery/kubernetes/requirements/"}),"requirements section"),"."),Object(o.b)("p",null,"For your EKS cluster, make sure that:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"you have the Kubeconfig of the cluster"),Object(o.b)("li",{parentName:"ul"},"(only if you want to use databases of type ",Object(o.b)("inlineCode",{parentName:"li"},"container")," with Qovery) the EKS worker nodes have a role assigned with the permission ",Object(o.b)("inlineCode",{parentName:"li"},"AmazonEBSCSIDriverPolicy"))),Object(o.b)(i.a,{type:"success",mdxType:"Alert"},Object(o.b)("p",null,"If you want to test Qovery BYOK on a demo cluster (K3s), follow ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"/docs/getting-started/install-qovery/kubernetes/create-k8s-cluster/"}),"this guide"),".")),Object(o.b)("h2",{id:"get-the-aws-credentials"},"Get the AWS credentials"),Object(o.b)(i.a,{type:"info",mdxType:"Alert"},Object(o.b)("p",null,"This step will not be necessary in the upcoming version of our self-managed offer.")),Object(o.b)(l.a,{headingDepth:3,mdxType:"Steps"},Object(o.b)("ol",null,Object(o.b)("li",null,Object(o.b)("p",null,"Create IAM user for Qovery"),Object(o.b)("p",null,"Create an IAM user on your AWS account and add the following in-line permissions to the user:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-json"}),'{\n    "Statement": [\n        {\n            "Action": [\n                "ecr:*",\n                "s3:ListAllMyBuckets"\n            ],\n            "Effect": "Allow",\n            "Resource": "*"\n        },\n        {\n            "Action": [\n                "s3:*"\n            ],\n            "Effect": "Allow",\n            "Resource": [\n                "arn:aws:s3:::qovery*",\n                "arn:aws:s3:::qovery*/*"\n            ]\n        },\n        {\n            "Action": [\n                "eks:AccessKubernetesApi",\n                "eks:Describe*",\n                "eks:List*"\n            ],\n            "Effect": "Allow",\n            "Resource": "*"\n        }\n    ],\n    "Version": "2012-10-17"\n}\n'))),Object(o.b)("li",null,Object(o.b)("p",null,"Create access keys"),Object(o.b)("p",null,"To create an ",Object(o.b)("inlineCode",{parentName:"p"},"access key id")," and ",Object(o.b)("inlineCode",{parentName:"p"},"secret access key"),", go to the Security Credentials tab of the ",Object(o.b)("inlineCode",{parentName:"p"},"Qovery")," user and press ",Object(o.b)("inlineCode",{parentName:"p"},"Create access key")),Object(o.b)("img",{src:"/img/aws/aws-create-credentials-1.png"}),Object(o.b)("img",{src:"/img/aws/aws-create-credentials-2.png"}),Object(o.b)("img",{src:"/img/aws/aws-create-credentials-3.png"}),Object(o.b)("p",null,"You can now save the ",Object(o.b)("inlineCode",{parentName:"p"},"access key id")," and ",Object(o.b)("inlineCode",{parentName:"p"},"secret access key")),Object(o.b)("img",{src:"/img/aws/aws-create-credentials-4.png"})),Object(o.b)("li",null,Object(o.b)("p",null,"Allow access to the cluster"),Object(o.b)("p",null,"Once the user is created, make sure it has the proper access permissions on the EKS cluster (",Object(o.b)("inlineCode",{parentName:"p"},"system:masters"),"). Example with ",Object(o.b)("inlineCode",{parentName:"p"},"eksctl")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-shell"}),"eksctl create iamidentitymapping --arn <iam_user_arn> --region <cluster_region> --username <user_name> --cluster <cluster_name> --group system:masters\n"))))),Object(o.b)("h2",{id:"install-qovery"},"Install Qovery"),Object(o.b)(l.a,{headingDepth:3,mdxType:"Steps"},Object(o.b)("ol",null,Object(o.b)("li",null,Object(o.b)("p",null,"Create a cluster on the Qovery console"),Object(o.b)("p",null,"Login to the ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://console.qovery.com"}),"Qovery console"),', and create a "Self-Managed" cluster.'),Object(o.b)("p",null,"Set the name of the cluster (1), the installation type ",Object(o.b)("inlineCode",{parentName:"p"},"Self-Managed")," (2) and add as ",Object(o.b)("inlineCode",{parentName:"p"},"Credentials")," (3) the AWS key that you have created in the previous step."),Object(o.b)("p",{align:"center"},Object(o.b)("img",{src:"/img/install-qovery/self-managed/general.png",alt:"Create Self-Managed cluster"})),Object(o.b)("p",null,'Add your cluster kubeconfig file, and click on "Continue".'),Object(o.b)("p",{align:"center"},Object(o.b)("img",{src:"/img/install-qovery/self-managed/kubeconfig.png",alt:"Add your Kubeconfig"})),Object(o.b)(i.a,{type:"warning",mdxType:"Alert"},Object(o.b)("p",null,"The credentials and the kubeconfig are temporary requirements that will disappear in the next versions. See the ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"/docs/getting-started/install-qovery/kubernetes/requirements/"}),"Requirements")," section for more information.")),Object(o.b)("p",null,"Verify your setup and create the cluster. At the end of this step, the cluster is created on the Qovery platform but not yet running on your AWS account."),Object(o.b)("p",{align:"center"},Object(o.b)("img",{src:"/img/install-qovery/self-managed/create.png",alt:"Create the cluster"})),Object(o.b)("p",null,"After creation, you'll finally be able to download a file containing the Qovery configuration for your cluster. The content of this file will be used later."),Object(o.b)("p",{align:"center"},Object(o.b)("img",{src:"/img/install-qovery/self-managed/qovery_override.png",alt:"Override Helm chart config"})),Object(o.b)("p",null,"Here is an example of the content override of the file:"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-yaml"}),'qovery:\n  clusterId: &clusterId XXXXXXX-XXX...\n  clusterShortId: &shortClusterId zXXXX\n  organizationId: &organizationId XXXXXXX-XXX...\n  jwtToken: &jwtToken "..."\n  domain: &domain "xxx.domain.org"\n  domainWildcard: &domainWildcard "*.xxx.domain.org"\n  qoveryDnsUrl: &qoveryDnsUrl https://xxx\n  lokiUrl: &lokiUrl http://loki.qovery.svc:3100\n  promtailLokiUrl: &promtailLokiUrl http://loki.qovery.svc:3100/loki/api/v1/push\n  acmeEmailAddr: &acmeEmailAddr "set-by-customer" # set your email address here for Let\'s encyrpt notification\n  externalDnsPrefix: &externalDnsPrefix "qvy-zxxx-"\n  architectures: &architectures "AMD64\n')),Object(o.b)("p",null,"Note: you can access again this installation section using the ",Object(o.b)("inlineCode",{parentName:"p"},"3 dots")," button next to the cluster name.")),Object(o.b)("li",null,Object(o.b)("p",null,"Prepare the values.yaml file"),Object(o.b)("p",null,"Now we have to build a values.yaml file to be used during the installation of the Qovery Helm charts on your cluster."),Object(o.b)("p",null,"You will find in the ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/Qovery/qovery-chart/tree/main/charts/qovery"}),"helm chart git repository")," a non exhaustive list of ",Object(o.b)("inlineCode",{parentName:"p"},"values")," example files that you can use to build your own configuration. The full list of parameters that can be configured within a values file can be found in the ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"/docs/getting-started/install-qovery/kubernetes/byok-config/"}),"Configuration page"),"."),Object(o.b)("p",null,"In the repository we provide two examples for AWS:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"values-demo-aws.yaml"),": this a pre-configured version to quickly setup Qovery on a demo cluster (",Object(o.b)("strong",{parentName:"li"},"do not use this configuration in production"),")"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"values-aws.yaml"),":  in this version you have to customize the entire Qovery installation. Adapt it based on your needs.")),Object(o.b)("p",null,"Once you have downloaded the example values file that you want to use:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"replace the ",Object(o.b)("inlineCode",{parentName:"li"},"qovery")," configuration part with the configuration retrieved from the Qovery console (see previous step)"),Object(o.b)("li",{parentName:"ul"},"update the configuration based on your needs. You can find all the possible parameters and configurations within the ",Object(o.b)("a",Object(r.a)({parentName:"li"},{href:"/docs/getting-started/install-qovery/kubernetes/byok-config/"}),"Configuration page"),"."),Object(o.b)("li",{parentName:"ul"},"make sure that every parameter has a value, there's a placeholder ",Object(o.b)("inlineCode",{parentName:"li"},"set-by-customer")," when your input is required."))),Object(o.b)("li",null,Object(o.b)("p",null,"Install ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://helm.sh"}),"Helm")," command line tool.")),Object(o.b)("li",null,Object(o.b)("p",null,"Add Qovery Helm repository."),Object(o.b)(i.a,{type:"warning",mdxType:"Alert"},Object(o.b)("p",null,"Qovery Helm Chart is only available for users who have access to Qovery BYOK. ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"https://www.qovery.com/solutions/bring-your-own-kubernetes"}),"Request your access here"),".")),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"helm repo add qovery https://helm.qovery.com/\nhelm repo update\n"))),Object(o.b)("li",null,Object(o.b)("p",null,"Install Qovery on your Kubernetes cluster."),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"helm upgrade --install --wait --atomic --create-namespace -n qovery -f <your-values-file.yaml> \\\n--set services.certificates.cert-manager-configs.enabled=false,services.certificates.qovery-cert-manager-webhook.enabled=false \\\nqovery qovery/qovery\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"-n qovery"),": the namespace where Qovery and its dependencies will be installed"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"--set..."),": override (only for the first deployment time, if you want to use Cert-Manager) to let cert-manager install its CRDs"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"-f your-values-file.yaml"),": the values file you've downloaded, overrided with the Qovery config and your custom config"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"qovery/qovery"),": name of the chart to deploy"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"qovery"),": name of the release")),Object(o.b)("p",null,"If you want to use Cert-Manager, you can remove the ",Object(o.b)("inlineCode",{parentName:"p"},"--set...")," for the future updates (or if already installed):"),Object(o.b)("pre",null,Object(o.b)("code",Object(r.a)({parentName:"pre"},{className:"language-bash"}),"helm upgrade --install --create-namespace -n qovery -f <your-values-file.yaml> qovery qovery/qovery\n")),Object(o.b)("p",null,"That's it, you can now use Qovery on your own Kubernetes cluster!")))),Object(o.b)("h2",{id:"validate-the-installation"},"Validate the installation"),Object(o.b)("p",null,"Follow the ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"/docs/getting-started/install-qovery/kubernetes/validate-installation/"}),"steps here"),"."),Object(o.b)("h2",{id:"further-configuration"},"Further configuration"),Object(o.b)("p",null,"Now that you have installed Qovery on your cluster, you can modify its configuration based on your need following the ",Object(o.b)("a",Object(r.a)({parentName:"p"},{href:"/docs/getting-started/install-qovery/kubernetes/byok-config/"}),"Qovery BYOK configuration guide"),"."))}p.isMDXComponent=!0},445:function(e,t,n){var r;!function(){"use strict";var n={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r)&&r.length){var l=a.apply(null,r);l&&e.push(l)}else if("object"===o)for(var i in r)n.call(r,i)&&r[i]&&e.push(i)}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(r=function(){return a}.apply(t,[]))||(e.exports=r)}()},446:function(e,t,n){"use strict";n(448);var r=n(0),a=n.n(r),o=n(445),l=n.n(o);n(132);t.a=function(e){var t=e.children,n=e.classNames,r=e.fill,o=e.icon,i=e.type,c=null;switch(i){case"danger":c="alert-triangle";break;case"success":c="check-circle";break;case"warning":c="alert-triangle";break;default:c="info"}return a.a.createElement("div",{className:l()(n,"alert","alert--"+i,{"alert--fill":r,"alert--icon":!1!==o}),role:"alert"},!1!==o&&a.a.createElement("i",{className:l()("feather","icon-"+(o||c))}),t)}},447:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m}));var r=n(0),a=n.n(r);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=a.a.createContext({}),u=function(e){var t=a.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i({},t,{},e)),n},b=function(e){var t=u(e.components);return a.a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},d=Object(r.forwardRef)((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),b=u(n),d=r,m=b["".concat(l,".").concat(d)]||b[d]||p[d]||o;return n?a.a.createElement(m,i({ref:t},s,{components:n})):a.a.createElement(m,i({ref:t},s))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=d;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:r,l[1]=i;for(var s=2;s<o;s++)l[s]=n[s];return a.a.createElement.apply(null,l)}return a.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},448:function(e,t,n){var r=n(12);r(r.P,"Array",{fill:n(449)}),n(74)("fill")},449:function(e,t,n){"use strict";var r=n(27),a=n(75),o=n(26);e.exports=function(e){for(var t=r(this),n=o(t.length),l=arguments.length,i=a(l>1?arguments[1]:void 0,n),c=l>2?arguments[2]:void 0,s=void 0===c?n:a(c,n);s>i;)t[i++]=e;return t}},453:function(e,t,n){"use strict";var r=n(457),a=n(51);function o(e,t){return t.encode?t.strict?r(e):encodeURIComponent(e):e}t.extract=function(e){return e.split("?")[1]||""},t.parse=function(e,t){var n=function(e){var t;switch(e.arrayFormat){case"index":return function(e,n,r){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return function(e,n,r){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};default:return function(e,t,n){void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t=a({arrayFormat:"none"},t)),r=Object.create(null);return"string"!=typeof e?r:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),a=t.shift(),o=t.length>0?t.join("="):void 0;o=void 0===o?null:decodeURIComponent(o),n(decodeURIComponent(a),o,r)})),Object.keys(r).sort().reduce((function(e,t){var n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return t[e]})):t}(n):e[t]=n,e}),Object.create(null))):r},t.stringify=function(e,t){var n=function(e){switch(e.arrayFormat){case"index":return function(t,n,r){return null===n?[o(t,e),"[",r,"]"].join(""):[o(t,e),"[",o(r,e),"]=",o(n,e)].join("")};case"bracket":return function(t,n){return null===n?o(t,e):[o(t,e),"[]=",o(n,e)].join("")};default:return function(t,n){return null===n?o(t,e):[o(t,e),"=",o(n,e)].join("")}}}(t=a({encode:!0,strict:!0,arrayFormat:"none"},t));return e?Object.keys(e).sort().map((function(r){var a=e[r];if(void 0===a)return"";if(null===a)return o(r,t);if(Array.isArray(a)){var l=[];return a.slice().forEach((function(e){void 0!==e&&l.push(n(r,e,l.length))})),l.join("&")}return o(r,t)+"="+o(a,t)})).filter((function(e){return e.length>0})).join("&"):""}},454:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=(n(445),n(453)),l=n.n(o);n(133);t.a=function(e){var t=e.children,n=e.headingDepth,o=e.hideFeedbackQuestion,i="undefined"!=typeof window?window.location:null,c={title:"Tutorial on "+i+" failed",body:"The tutorial on:\n\n"+i+"\n\nHere's what went wrong:\n\n\x3c!-- Insert command output and details. Thank you for reporting! :) --\x3e"},s="https://github.com/qovery/documentation/issues/new?"+l.a.stringify(c),u=Object(r.useState)(null),b=u[0],p=u[1];return a.a.createElement("div",{className:"steps steps--h"+n},t,!o&&!b&&a.a.createElement("div",{className:"steps--feedback"},"How was it? Did this tutorial work?\xa0\xa0",a.a.createElement("span",{className:"button button--sm button--primary",onClick:function(){return p("yes")}},"Yes"),"\xa0\xa0",a.a.createElement("a",{href:s,target:"_blank",className:"button button--sm button--primary"},"No")),"yes"==b&&a.a.createElement("div",{className:"steps--feedback steps--feedback--success"},"Thanks! If you're enjoying Qovery please consider ",a.a.createElement("a",{href:"https://github.com/qovery/documentation/",target:"_blank"},"starring our Github repo"),"."))}},457:function(e,t,n){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}}}]);